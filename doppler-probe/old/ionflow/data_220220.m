if nz == 1
    if t == 465
        ICCD_file1 = '/Users/Ryo/Doppler/220220/ascii/shot6_464us_w=2_gain=3300.asc';%ICCDファイル名
        ICCD_file2 = '/Users/Ryo/Doppler/220220/ascii/shot7_464us_w=2_gain=3300.asc';%ICCDファイル名
        ICCD_file3 = '/Users/Ryo/Doppler/220220/ascii/shot8_464us_w=2_gain=3300.asc';%ICCDファイル名
        ICCD_file4 = '/Users/Ryo/Doppler/220220/ascii/shot9_464us_w=2_gain=3300.asc';%ICCDファイル名
        ICCD_file5 = '/Users/Ryo/Doppler/220220/ascii/shot10_464us_w=2_gain=3300.asc';%ICCDファイル名
    end
    if t == 467
        ICCD_file1 = '/Users/Ryo/Doppler/220220/ascii/shot11_466us_w=2_gain=3300.asc';%ICCDファイル名
        ICCD_file2 = '/Users/Ryo/Doppler/220220/ascii/shot12_466us_w=2_gain=3300.asc';%ICCDファイル名
        ICCD_file3 = '/Users/Ryo/Doppler/220220/ascii/shot13_466us_w=2_gain=3300.asc';%ICCDファイル名
        ICCD_file4 = '/Users/Ryo/Doppler/220220/ascii/shot14_466us_w=2_gain=3300.asc';%ICCDファイル名
        ICCD_file5 = '/Users/Ryo/Doppler/220220/ascii/shot15_466us_w=2_gain=3300.asc';%ICCDファイル名
    end
    if t == 469
        ICCD_file1 = '/Users/Ryo/Doppler/220220/ascii/shot18_468us_w=2_gain=3300.asc';%ICCDファイル名
        ICCD_file2 = '/Users/Ryo/Doppler/220220/ascii/shot19_468us_w=2_gain=3300.asc';%ICCDファイル名
        ICCD_file3 = '/Users/Ryo/Doppler/220220/ascii/shot20_468us_w=2_gain=3300.asc';%ICCDファイル名
        ICCD_file4 = '/Users/Ryo/Doppler/220220/ascii/shot21_468us_w=2_gain=3300.asc';%ICCDファイル名
        ICCD_file5 = '/Users/Ryo/Doppler/220220/ascii/shot22_468us_w=2_gain=3300.asc';%ICCDファイル名
    end
    if t == 471
        ICCD_file1 = '/Users/Ryo/Doppler/220220/ascii/shot23_470us_w=2_gain=3300.asc';%ICCDファイル名
        ICCD_file2 = '/Users/Ryo/Doppler/220220/ascii/shot24_470us_w=2_gain=3300.asc';%ICCDファイル名
        ICCD_file3 = '/Users/Ryo/Doppler/220220/ascii/shot25_470us_w=2_gain=3300.asc';%ICCDファイル名
        ICCD_file4 = '/Users/Ryo/Doppler/220220/ascii/shot26_470us_w=2_gain=3300.asc';%ICCDファイル名
        ICCD_file5 = '/Users/Ryo/Doppler/220220/ascii/shot27_470us_w=2_gain=3300.asc';%ICCDファイル名
    end
    if t == 473
        ICCD_file1 = '/Users/Ryo/Doppler/220220/ascii/shot28_472us_w=2_gain=3300.asc';%ICCDファイル名
        ICCD_file2 = '/Users/Ryo/Doppler/220220/ascii/shot29_472us_w=2_gain=3300.asc';%ICCDファイル名
        ICCD_file3 = '/Users/Ryo/Doppler/220220/ascii/shot30_472us_w=2_gain=3300.asc';%ICCDファイル名
        ICCD_file4 = '/Users/Ryo/Doppler/220220/ascii/shot31_472us_w=2_gain=3300.asc';%ICCDファイル名
        ICCD_file5 = '/Users/Ryo/Doppler/220220/ascii/shot32_472us_w=2_gain=3300.asc';%ICCDファイル名
    end
    if t == 475
        ICCD_file1 = '/Users/Ryo/Doppler/220220/ascii/shot33_474us_w=2_gain=3300.asc';%ICCDファイル名
        ICCD_file2 = '/Users/Ryo/Doppler/220220/ascii/shot34_474us_w=2_gain=3300.asc';%ICCDファイル名
        ICCD_file3 = '/Users/Ryo/Doppler/220220/ascii/shot35_474us_w=2_gain=3300.asc';%ICCDファイル名
        ICCD_file4 = '/Users/Ryo/Doppler/220220/ascii/shot36_474us_w=2_gain=3300.asc';%ICCDファイル名
        ICCD_file5 = '/Users/Ryo/Doppler/220220/ascii/shot37_474us_w=2_gain=3300.asc';%ICCDファイル名
    end
    if t == 477
        ICCD_file1 = '/Users/Ryo/Doppler/220220/ascii/shot38_476us_w=2_gain=3300.asc';%ICCDファイル名
        ICCD_file2 = '/Users/Ryo/Doppler/220220/ascii/shot39_476us_w=2_gain=3300.asc';%ICCDファイル名
        ICCD_file3 = '/Users/Ryo/Doppler/220220/ascii/shot40_476us_w=2_gain=3000.asc';%ICCDファイル名
        ICCD_file4 = '/Users/Ryo/Doppler/220220/ascii/shot41_476us_w=2_gain=3000.asc';%ICCDファイル名
        ICCD_file5 = '/Users/Ryo/Doppler/220220/ascii/shot42_476us_w=2_gain=3000.asc';%ICCDファイル名
    end
    if t == 479
        ICCD_file1 = '/Users/Ryo/Doppler/220220/ascii/shot43_478us_w=2_gain=3000.asc';%ICCDファイル名
        ICCD_file2 = '/Users/Ryo/Doppler/220220/ascii/shot44_478us_w=2_gain=3000.asc';%ICCDファイル名
        ICCD_file3 = '/Users/Ryo/Doppler/220220/ascii/shot45_478us_w=2_gain=3000.asc';%ICCDファイル名
        ICCD_file4 = '/Users/Ryo/Doppler/220220/ascii/shot46_478us_w=2_gain=3000.asc';%ICCDファイル名
        ICCD_file5 = '/Users/Ryo/Doppler/220220/ascii/shot47_478us_w=2_gain=3000.asc';%ICCDファイル名
    end
    if t == 481
        ICCD_file1 = '/Users/Ryo/Doppler/220220/ascii/shot48_480us_w=2_gain=3000.asc';%ICCDファイル名
        ICCD_file2 = '/Users/Ryo/Doppler/220220/ascii/shot49_480us_w=2_gain=3000.asc';%ICCDファイル名
        ICCD_file3 = '/Users/Ryo/Doppler/220220/ascii/shot50_480us_w=2_gain=3000.asc';%ICCDファイル名
        ICCD_file4 = '/Users/Ryo/Doppler/220220/ascii/shot51_480us_w=2_gain=3000.asc';%ICCDファイル名
        ICCD_file5 = '/Users/Ryo/Doppler/220220/ascii/shot55_480us_w=2_gain=3000.asc';%ICCDファイル名
    end
    if ndata == 1
        filename1 = ICCD_file1;
    elseif ndata == 2
        filename1 = ICCD_file2;
    elseif ndata == 3
        filename1 = ICCD_file3;
    elseif ndata == 4
        filename1 = ICCD_file4;
    elseif ndata == 5
        filename1 = ICCD_file5;
    end
end

if nz == 2
    if t == 465
        ICCD_file1 = '/Users/Ryo/Doppler/211110/ascii/shot49_464us_w=2_gain=3800.asc';%ICCDファイル名
        ICCD_file2 = '/Users/Ryo/Doppler/211110/ascii/shot50_464us_w=2_gain=3800.asc';%ICCDファイル名
        ICCD_file3 = '/Users/Ryo/Doppler/211110/ascii/shot51_464us_w=2_gain=3800.asc';%ICCDファイル名
        ICCD_file4 = '/Users/Ryo/Doppler/211110/ascii/shot52_464us_w=2_gain=3900.asc';%ICCDファイル名
        ICCD_file5 = '/Users/Ryo/Doppler/211110/ascii/shot53_464us_w=2_gain=3900.asc';%ICCDファイル名
    end
    if t == 467
        ICCD_file1 = '/Users/Ryo/Doppler/211110/ascii/shot33_466us_w=2_gain=3500.asc';%ICCDファイル名
        ICCD_file2 = '/Users/Ryo/Doppler/211110/ascii/shot34_466us_w=2_gain=3800.asc';%ICCDファイル名
        ICCD_file3 = '/Users/Ryo/Doppler/211110/ascii/shot35_466us_w=2_gain=3800.asc';%ICCDファイル名
        ICCD_file4 = '/Users/Ryo/Doppler/211110/ascii/shot36_466us_w=2_gain=3800.asc';%ICCDファイル名
        ICCD_file5 = '/Users/Ryo/Doppler/211110/ascii/shot37_466us_w=2_gain=3800.asc';%ICCDファイル名
    end
    if t == 469
        ICCD_file1 = '/Users/Ryo/Doppler/211110/ascii/shot5_468us_w=2_gain=3500.asc';%ICCDファイル名
        ICCD_file2 = '/Users/Ryo/Doppler/211110/ascii/shot6_468us_w=2_gain=3500.asc';%ICCDファイル名
        ICCD_file3 = '/Users/Ryo/Doppler/211110/ascii/shot7_468us_w=2_gain=3500.asc';%ICCDファイル名
        ICCD_file4 = '/Users/Ryo/Doppler/211110/ascii/shot8_468us_w=2_gain=3500.asc';%ICCDファイル名
        ICCD_file5 = '/Users/Ryo/Doppler/211110/ascii/shot9_468us_w=2_gain=3500.asc';%ICCDファイル名
    end
    if t == 471
        ICCD_file1 = '/Users/Ryo/Doppler/211110/ascii/shot12_470us_w=2_gain=3300.asc';%ICCDファイル名
        ICCD_file2 = '/Users/Ryo/Doppler/211110/ascii/shot13_470us_w=2_gain=3400.asc';%ICCDファイル名
        ICCD_file3 = '/Users/Ryo/Doppler/211110/ascii/shot14_470us_w=2_gain=3400.asc';%ICCDファイル名
        ICCD_file4 = '/Users/Ryo/Doppler/211110/ascii/shot16_470us_w=2_gain=3400.asc';%ICCDファイル名
        ICCD_file5 = '/Users/Ryo/Doppler/211110/ascii/shot17_470us_w=2_gain=3400.asc';%ICCDファイル名
    end
    if t == 473
        ICCD_file1 = '/Users/Ryo/Doppler/211110/ascii/shot20_472us_w=2_gain=3400.asc';%ICCDファイル名
        ICCD_file2 = '/Users/Ryo/Doppler/211110/ascii/shot21_472us_w=2_gain=3300.asc';%ICCDファイル名
        ICCD_file3 = '/Users/Ryo/Doppler/211110/ascii/shot22_472us_w=2_gain=3300.asc';%ICCDファイル名
        ICCD_file4 = '/Users/Ryo/Doppler/211110/ascii/shot23_472us_w=2_gain=3300.asc';%ICCDファイル名
        ICCD_file5 = '/Users/Ryo/Doppler/211110/ascii/shot26_472us_w=2_gain=3300.asc';%ICCDファイル名
    end
    if t == 475
        ICCD_file1 = '/Users/Ryo/Doppler/211110/ascii/shot27_474us_w=2_gain=3300.asc';%ICCDファイル名
        ICCD_file2 = '/Users/Ryo/Doppler/211110/ascii/shot28_474us_w=2_gain=3300.asc';%ICCDファイル名
        ICCD_file3 = '/Users/Ryo/Doppler/211110/ascii/shot29_474us_w=2_gain=3300.asc';%ICCDファイル名
        ICCD_file4 = '/Users/Ryo/Doppler/211110/ascii/shot30_474us_w=2_gain=3300.asc';%ICCDファイル名
        ICCD_file5 = '/Users/Ryo/Doppler/211110/ascii/shot31_474us_w=2_gain=3300.asc';%ICCDファイル名
    end
end




% %アルゴンの時
% center_file = 'Xe_96120_calibration_new.txt';%中心データファイル名
% % %水素の時
% % center_file = 'Hbeta_calibration.txt';%中心データファイル名
%
% %データのインポート
% data1 = importdata(ICCD_file1);%ICCD画像データを取得
% data2 = importdata(ICCD_file2);%ICCD画像データを取得
% data3 = importdata(ICCD_file3);%ICCD画像データを取得
% data4 = importdata(ICCD_file4);%ICCD画像データを取得
% data5 = importdata(ICCD_file5);%ICCD画像データを取得
% % data = (data1+data2+data3+data4+data5)/5;
% % data = (data1+data2+data3)/3;
% if ndata == 1
%     data = data1;
% end
% if ndata == 2
%     data = data2;
% end
% if ndata == 3
%     data = data3;
% end
% if ndata == 4
%     data = data4;
% end
% if ndata == 5
%     data = data5;
% end
%
% center = importdata(center_file);%中心座標を取得
% centerX = center(:,3);%チャンネル対応中心相対X座標
% centerY = center(:,2);%チャンネル対応中心Y座標
% inst = center(:,5);%チャンネル装置関数
%
% %軸の定義
% Px = data(:,1);%ピクセル軸を定義(1~1024)
% [numPx,n1]=size(data);%Px軸の長さを取得
% Lambda = zeros(numPx,numCh);%λ軸(チャンネルにより変わる)
% px2nm = zeros(numCh,1);%nm/pixel
%
% %アルゴンの時
% lambda = [lambda1 lambda2];
% for i = 1:numCh
%     pixel = [center(i,3) center(i,4)];
%     p = polyfit(pixel,lambda,1);
%     px2nm(i,1) = p(1);
%     Lambda(:,i) = polyval(p,Px);
% end
% deltaLambda = mean(px2nm, 'all');%Δλ
%
% % %水素の時
% % for i = 1:numCh
% %     px2nm(i,1) = 0.00536;
% %     Lambda(:,i) = px2nm(i,1)*(Px-centerX(i))+lambda0;
% % end
% % deltaLambda = 0.00536;%Δλ
%
% numVx = numLambda;
% deltaVx = deltaLambda/lambda0*Vc;%ΔVx
% Vx = linspace(-deltaVx*(numVx-1)/2,deltaVx*(numVx-1)/2,numVx);%Vx軸
% numVy = numLambda;
% deltaVy = deltaLambda/lambda0*Vc;%ΔVy
% Vy = linspace(-deltaVy*(numVy-1)/2,deltaVy*(numVy-1)/2,numVy);%Vy軸
%
% %分光データを整形
% Spectrum = zeros(numPx,numCh);%分光dataを入れる
% for i = 1:numCh
%     Spectrum(:,i) = ...
%         sum(data(:,round(centerY(i+4*(nr-1))-width):round(centerY(i+4*(nr-1))+width)),2);
% end
%
% %移動平均をとる
% for i = 1:numCh
%     Spectrum(:,i) = movmean(Spectrum(:,i),movlen);
% end
%
% %-----対抗視線のフィッティングを行うことでオフセットを求め、λ軸を較正------
% shift = zeros(2,1);
% for i = 1:2
%     S1 = [Lambda(:,i) Spectrum(:,i)]; %i番目のチャンネルの[X,Y]
%     %     s1 = size(S1);%S1の[行数,列数]
%     %     MAX1 = max(Spectrum(:,i)); %スペクトルの最大値
%     %     j = 1;
%     %     while j < s1(1)+1 %SNの悪いデータを除く
%     %         if S1(j,2) < MAX1*0.5
%     %             S1(j,:) = [];
%     %         else
%     %             j = j+1;
%     %         end
%     %         s1 = size(S1);
%     %     end
%     f = fit(S1(:,1),S1(:,2),'gauss1');
%     coef=coeffvalues(f);
%     shift(i,1) = coef(2)-lambda0;
% end
% offset = (shift(1,1) + shift(2,1))/2;%対抗視線から得られたオフセット[nm]
% Lambda = Lambda - offset;%オフセットを引きλ軸を較正
%
% %-----------------再構成できるデータ形式に変換---------------------
% %V=0付近のデータを抽出
% ShiftLambda = zeros(numLambda,numCh);
% ArrangedSpectrum = zeros(numLambda,numCh);
% for i = 1:numCh
%     IDX = knnsearch(Lambda(:,i),lambda0);
%     ShiftLambda(:,i) = Lambda(IDX-(numLambda-1)/2:IDX+(numLambda-1)/2,i)-lambda0;
%     ArrangedSpectrum(:,i) = Spectrum(IDX-(numLambda-1)/2:IDX+(numLambda-1)/2,i);
% end
%
% % %逆畳み込み(できていない)
% % numZ = 5;
% % Z = zeros(numZ,numCh);
% % ZArrangedSpectrum = cat(1,Z,ArrangedSpectrum);
% % ZArrangedSpectrumZ = cat(1,ZArrangedSpectrum,Z);
% % for i = 1:numCh
% %     x = linspace(-numZ,numZ,2*numZ+1);
% %     Inst = 10*exp(-(x/instrument(i)).^2);%装置関数
% %     [ArrangedSpectrum(:,i),res] = deconv(ZArrangedSpectrumZ(:,i),Inst);
% % end
% % plot(ShiftLambda(:,1),ArrangedSpectrum(:,1))
%
% %データを規格化
% factor = 100;
% for i = 1:numCh
%     ArrangedSpectrum(:,i) = ArrangedSpectrum(:,i)/sum(ArrangedSpectrum(:,i))*100;
% end
% %1次元配列Pを生成(numMea個作る必要がある)
% P = cat(1, ArrangedSpectrum(:,2),ArrangedSpectrum(:,4),ArrangedSpectrum(:,3));
%
